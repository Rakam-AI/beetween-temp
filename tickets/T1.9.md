# T1.9 - Update ArchUnit Tests for New Architecture


**Depends on:** T1.2, T1.7
**Blocks:** None (quality gate)

**Context:**
The existing ArchUnit tests enforce hexagonal architecture boundaries. They need to be updated for the new package structure which now has domain contexts (`request`, `workflow`) and follows the structure from the API specification.

**Objective:**
Update all ArchUnit tests to enforce the correct boundaries for the new DAR project structure.

**Instructions:**
1. **Update `CleanArchitectureTest.kt`:**
   - Domain packages (`domain.request`, `domain.workflow`, `domain.shared`) must NOT depend on:
     - Spring framework
     - Application layer
     - Adapter layer
     - Config/Infra layer
   - Application packages (`application.request`, `application.workflow`) must NOT depend on:
     - Spring framework
     - Adapter layer
     - Config/Infra layer
   - Application may depend on Domain
   - Inbound adapters (`adapter.input`) must NOT depend on:
     - Domain layer directly (must go through application ports)
     - Outbound adapters
   - Outbound adapters (`adapter.output`) may depend on:
     - Application output ports
     - Domain model (for mapping)
   - Config/Infra may depend on everything (it's the composition root)

2. **Update `NamingRulesTest.kt`:**
   - Controllers must end with `Controller`
   - Use cases must end with `UseCase`
   - Repositories (ports) must end with `Repository` or `Port`
   - Domain events must end with event-related naming
   - DTOs in adapter layer must end with `Dto`, `Input`, or `Output`

3. **Update `ApiSurfaceRulesTest.kt`:**
   - All `@RestController` classes must be in `adapter.input.web` package
   - All controller methods must return `ApiResponse<*>` or `ResponseEntity<*>`

4. **Update `ApplicationServiceRulesTest.kt`:**
   - Application services must implement a port interface
   - Application services must not directly use infrastructure classes

**Acceptance Criteria:**
- All ArchUnit tests compile (they may fail until implementations exist, that's fine)
- Architecture rules are clearly documented in test names
- Tests cover the two domain contexts (request, workflow)
