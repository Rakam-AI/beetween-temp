# T1.8 - Set Up Base Response Wrapper & Pagination DTOs


**Depends on:** T1.2
**Blocks:** T2.12, T2.13

**Context:**
The API specification requires all responses to use a standardized wrapper format with `data`, `message`, and optional `pagination` and `errors` fields. This must be set up as shared infrastructure before implementing endpoints.

Reference: `API_Technical Specification V1.md` > Response Wrapper format throughout all endpoints

**Objective:**
Create the shared response wrapper, pagination, and error DTOs used across all REST endpoints.

**Instructions:**
1. **Create `adapter/input/web/shared/dto/ApiResponse.kt`:**
   ```kotlin
   data class ApiResponse<T>(
       val message: String,
       val data: T? = null,
       val pagination: PaginationInfo? = null,
       val errors: List<ApiError>? = null
   )
   ```

2. **Create `adapter/input/web/shared/dto/PaginationInfo.kt`:**
   ```kotlin
   data class PaginationInfo(
       val page: Int,
       val size: Int,
       val totalCount: Long,
       val totalPages: Int,
       val hasNext: Boolean
   )
   ```

3. **Create `adapter/input/web/shared/dto/ApiError.kt`:**
   ```kotlin
   data class ApiError(
       val code: String,
       val message: String,
       val field: String? = null
   )
   ```

4. **Create `application/shared/model/PageRequest.kt`:**
   ```kotlin
   data class PageRequest(
       val page: Int = 1,
       val size: Int = 10
   ) {
       init {
           require(page >= 1) { "Page must be >= 1" }
           require(size in 1..100) { "Size must be between 1 and 100" }
       }
   }
   ```

5. **Create `application/shared/model/PageResult.kt`:**
   ```kotlin
   data class PageResult<T>(
       val items: List<T>,
       val page: Int,
       val size: Int,
       val totalCount: Long
   ) {
       val totalPages: Int get() = ((totalCount + size - 1) / size).toInt()
       val hasNext: Boolean get() = page < totalPages
   }
   ```

6. **Update `GlobalExceptionHandler`** to use the new `ApiResponse` wrapper for error responses:
   - All error responses should return `ApiResponse<Nothing>` with the `errors` field populated
   - Map existing exception types to appropriate HTTP status codes
   - Add handlers for: `MethodArgumentNotValidException` (400), `AccessDeniedException` (403), `NoHandlerFoundException` (404)

**Acceptance Criteria:**
- All DTO classes compile and have proper serialization
- GlobalExceptionHandler returns errors in the standardized format
- Pagination defaults are page=1, size=10, max size=100
